FROM arm32v7/rust

RUN apt-get update

ENV NIGHTLY_DATE 2019-05-25

ENV RUST_BACKTRACE 1

# ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è
# ‚ö†Ô∏è specify a known, working version of nightly 
# ‚ö†Ô∏è to avoid Signal 11 mem alloc failures üò©üî•
# ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è
RUN rustup default nightly-${NIGHTLY_DATE}

WORKDIR /sensor_tracker

COPY . .

# üèó make sure rand_hc builds
# üëÄ https://github.com/actix/actix/issues/184
# üëÄ https://github.com/rust-random/rand/issues/645
RUN cargo update

#TODO
CMD ["tail","-f","/dev/null"]

#TODO 
#RUN cargo install --path .

# üõÄ shrink image size
#TODO
#RUN sh shrink_docker_image.sh

#TODO
#CMD ["sensor_tracker"]
